import{_ as q,b as w,m as U,r,o as _,c as p,e as n,d as e,F as g,j as $,t as h,w as E,n as i,k as y,v as V}from"./index-217795b9.js";import{c as k}from"./cart-16ac4cb7.js";import{N as T}from"./NavProduct-f3649a48.js";const{VITE_URL:f,VITE_PATH:b}={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"koung-hexschool",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},N={components:{NavProduct:T},data(){return{loadingItem:!1,form:{user:{name:"",email:"",tel:"",address:""}},message:"",orderId:""}},methods:{...w(k,["addToCart","updataCartItem","deleteItem","deleteAllCarts","getCart"]),createOrder(){const o=this.form;this.$http.post(`${f}/v2/api/${b}/order`,{data:o}).then(t=>{this.$refs.form.resetForm(),this.orderId=t.data.orderId,this.$router.push(`/cartcheck/${this.orderId}`),this.getCart()}).catch(t=>{alert(t.response.data.message)})},plusQty(o){const t={product_id:o.product_id,qty:o.qty+1};this.$http.put(`${f}/v2/api/${b}/cart/${o.id}`,{data:t}).then(d=>{console.log(d),this.getCart()}).catch(d=>{alert(d.response.data.message)})},dashQty(o){const t={product_id:o.product_id,qty:o.qty-1};this.$http.put(`${f}/v2/api/${b}/cart/${o.id}`,{data:t}).then(d=>{console.log(d),this.getCart()}).catch(d=>{alert(d.response.data.message)})}},computed:{...U(k,["carts","total","final_total"])},mounted(){this.getCart()}},S={class:"container py-7"},j={class:"row g-5"},A={class:"col-md-7"},L=e("h1",{class:"text-center py-5"},"購物清單列表",-1),P={class:"col-1 d-flex align-items-center justify-content-center"},D=["disabled","onClick"],R={class:"col-4 d-flex align-items-center justify-content-center"},B=["src"],O={class:"col-7 d-flex justify-content-between flex-column"},Q={class:"col text-success fs-5 fw-bolder"},F={class:"input-group py-2"},z={class:"input-group-prepend"},H=["onClick"],M=e("i",{class:"bi bi-dash-lg"},null,-1),G=[M],J=["onUpdate:modelValue"],K={class:"input-group-append"},W=["onClick"],X=e("i",{class:"bi bi-plus-lg"},null,-1),Y=[X],Z={class:"pt-2"},ee=e("hr",null,null,-1),te={class:"d-flex justify-content-between align-items-center"},se=["disabled"],oe={class:"text-end"},le=e("h1",{class:"text-center"},"訂單聯絡資料",-1),ae={class:"mb-3"},ne=e("label",{for:"email",class:"form-label"},"Email",-1),de={class:"mb-3"},re=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),ie={class:"mb-3"},ce=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),me={class:"mb-3"},ue=e("label",{for:"address",class:"form-label"},"收件人地址",-1),_e={class:"mb-3"},pe=e("label",{for:"message",class:"form-label"},"留言",-1),he=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-danger"},"送出訂單")],-1);function fe(o,t,d,be,a,u){var v;const x=r("VueLoading"),C=r("NavProduct"),c=r("v-field"),m=r("error-message"),I=r("v-form");return _(),p(g,null,[n(x,{active:a.loadingItem,"z-index":1060},null,8,["active"]),n(C),e("div",S,[e("div",j,[e("div",A,[L,(_(!0),p(g,null,$(o.carts,s=>(_(),p("div",{key:s.id,class:"border-top row py-3"},[e("div",P,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:s.id===a.loadingItem,onClick:l=>o.deleteItem(s)},"x ",8,D)]),e("div",R,[e("img",{src:s.product.imageUrl,class:"d-block object-fit-cover",width:"120",height:"120",alt:""},null,8,B)]),e("div",O,[e("div",Q,h(s.product.title),1),e("div",F,[e("div",z,[e("button",{class:i(["btn btn-outline-dark",{disabled:s.qty==1}]),onClick:l=>u.dashQty(s)},G,10,H)]),y(e("input",{class:"form-control text-center",readonly:"",type:"number",min:"1","onUpdate:modelValue":l=>s.qty=l},null,8,J),[[V,s.qty]]),e("div",K,[e("button",{class:"btn btn-outline-dark",onClick:l=>u.plusQty(s)},Y,8,W)])]),e("small",Z,"價格： NT$"+h(s.final_total),1)])]))),128)),ee,e("div",te,[e("button",{class:"btn btn-outline-danger",type:"button",onClick:t[0]||(t[0]=s=>o.deleteAllCarts()),disabled:((v=o.carts)==null?void 0:v.length)===0},"清空購物車",8,se),e("span",oe,"總金額:NT$"+h(o.total),1)])]),n(I,{ref:"form",class:"col-md-5 bg-light rounded-3 py-5",onSubmit:u.createOrder},{default:E(({errors:s})=>[le,e("div",ae,[ne,n(c,{id:"email",name:"email",type:"email",class:i(["form-control",{"is-invalid":s.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:a.form.user.email,"onUpdate:modelValue":t[1]||(t[1]=l=>a.form.user.email=l)},null,8,["class","modelValue"]),n(m,{name:"email",class:"invalid-feedback"})]),e("div",de,[re,n(c,{id:"name",name:"姓名",type:"text",class:i(["form-control",{"is-invalid":s.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:a.form.user.name,"onUpdate:modelValue":t[2]||(t[2]=l=>a.form.user.name=l)},null,8,["class","modelValue"]),n(m,{name:"姓名",class:"invalid-feedback"})]),e("div",ie,[ce,n(c,{id:"tel",name:"電話",type:"text",class:i(["form-control",{"is-invalid":s.電話}]),placeholder:"請輸入電話",rules:{numeric:!0,required:!0,min:8,regex:/^(09)([0-9]{2})([0-9]{6})$|^(0)([0-9]{1})([0-9]{6,8})$/},modelValue:a.form.user.tel,"onUpdate:modelValue":t[3]||(t[3]=l=>a.form.user.tel=l)},null,8,["class","rules","modelValue"]),n(m,{name:"電話",class:"invalid-feedback"})]),e("div",me,[ue,n(c,{id:"address",name:"地址",type:"text",class:i(["form-control",{"is-invalid":s.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:a.form.user.address,"onUpdate:modelValue":t[4]||(t[4]=l=>a.form.user.address=l)},null,8,["class","modelValue"]),n(m,{name:"地址",class:"invalid-feedback"})]),e("div",_e,[pe,y(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[5]||(t[5]=l=>a.form.message=l)},null,512),[[V,a.form.message]])]),he]),_:1},8,["onSubmit"])])])],64)}const Ve=q(N,[["render",fe]]);export{Ve as default};
